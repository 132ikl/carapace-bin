FROM mcr.microsoft.com/powershell

RUN mkdir -p /root/.config/powershell \
 && echo "\n\
function prompt {Write-Host \"carapace\" -NoNewLine -ForegroundColor 3; return \" \"}\n\
Set-PSReadlineKeyHandler -Key Tab -Function MenuComplete\n\
carapace _carapace powershell | out-string | Invoke-Expression\n\
carapace --list | foreach { carapace \$_ | Out-String | Invoke-Expression} " \
       > /root/.config/powershell/Microsoft.PowerShell_profile.ps1

RUN ln -s /carapace-completers/carapace/carapace /usr/local/bin/carapace

